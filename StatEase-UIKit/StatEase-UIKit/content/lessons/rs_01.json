{
  "id": "rs_01",
  "title": "最小二乗法",
  "subtitle": "最小二乗法の理解",
  "estimated_minutes": 5,
  "category": "regression_simple",
  "topic": "単回帰と予測",
  "summary": "観測値と予測値のズレ二乗和を最小化して回帰直線を求める最小二乗法の考え方と手順を整理します。",
  "learning_objectives": [
    "最小二乗法の目的を説明できる",
    "単回帰における係数の求め方を導出できる",
    "最小二乗推定の性質と注意点を述べられる"
  ],
  "prerequisites": [],
  "steps": [
    {
      "id": "rs_01_step01",
      "order": 1,
      "type": "text",
      "title": "最小二乗法の考え方",
      "body": "",
      "paragraphs": [
        {
          "title": "二乗誤差を最小に",
          "body": "最小二乗法では、観測値 \\(y_i\\) と予測値 \\(\\hat{y}_i\\) の差（残差）を二乗した和を最小化するように回帰直線の係数を選びます。外れ値をある程度抑制しつつ解析的に解けるのが長所です。"
        },
        {
          "title": "単回帰モデル",
          "body": "単回帰では \\(\\hat{y}_i = \\beta_0 + \\beta_1 x_i\\) と置き、\\(S(\\beta_0, \\beta_1) = \\sum (y_i - \\beta_0 - \\beta_1 x_i)^2\\) を最小にする \\(\\beta_0,\\beta_1\\) を求めます。"
        }
      ]
    },
    {
      "id": "rs_01_step02",
      "order": 2,
      "type": "text",
      "title": "解の導出",
      "body": "",
      "paragraphs": [
        {
          "title": "偏微分して0に",
          "body": "二乗和を係数で微分し0とおくと、正規方程式 \\(\\sum (y_i - \\beta_0 - \\beta_1 x_i) = 0\\)、\\(\\sum x_i (y_i - \\beta_0 - \\beta_1 x_i) = 0\\) が得られます。これを解くと係数の推定式が導出されます。"
        },
        {
          "title": "単回帰の閉形式",
          "body": "傾き \\(\\hat{\\beta}_1 = \\frac{\\sum (x_i-\\bar{x})(y_i-\\bar{y})}{\\sum (x_i-\\bar{x})^2}\\)、切片 \\(\\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x}\\)。共分散を分散で割る形になっている点に注目しましょう。"
        }
      ]
    },
    {
      "id": "rs_01_step03",
      "order": 3,
      "type": "text",
      "title": "例：広告費と売上",
      "body": "",
      "paragraphs": [
        {
          "title": "計算結果",
          "body": "広告費（百万円）と売上（千万円）の5ペアのデータに最小二乗法を適用したところ、傾き 8.2、切片 35 という式が得られました。広告費1百万円の増加で売上が8.2千万円増える予測です。"
        },
        {
          "title": "残差の確認",
          "body": "回帰直線に対する残差プロットを描き、非線形なパターンや外れ値がないかをチェックします。最小二乗法は残差が独立で分散が一定という仮定の下で性能を発揮します。"
        }
      ]
    },
    {
      "id": "rs_01_step04",
      "order": 4,
      "type": "text",
      "title": "性質と注意点",
      "body": "",
      "paragraphs": [
        {
          "title": "BLUE",
          "body": "古典的な仮定（線形性、誤差の独立・等分散・平均0）を満たす場合、最小二乗推定量はガウス・マルコフ定理により最良線形不偏推定量（BLUE）となります。"
        },
        {
          "title": "外れ値への感度",
          "body": "誤差を二乗するため、極端な外れ値が1つあるだけで係数が大きく変わる場合があります。外れ値が疑われる場合はロバスト回帰や変数変換も検討しましょう。"
        }
      ]
    }
  ],
  "resources": {
    "key_terms": [
      "最小二乗法",
      "残差",
      "正規方程式"
    ],
    "external_links": []
  }
}
