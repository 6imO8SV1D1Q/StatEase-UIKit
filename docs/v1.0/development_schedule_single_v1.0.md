# StatEase-UIKit 開発スケジュール v1.0

**作成日**: 2025-11-15
**対象**: MVP（記述統計9レッスン + 基本機能）

---

## 📋 スケジュール概要

全体を **6つのフェーズ** に分割し、段階的に実装します。
各フェーズは独立したマイルストーンとして機能します。

**想定期間**: 約 4〜6週間（個人開発、1日2〜3時間の作業を想定）

---

## Phase 1: 基盤構築 📐
**期間**: 3〜4日
**目的**: プロジェクト構造とデータモデルの確立

### タスク

- [ ] **1.1 プロジェクト構造の整備**
  - ディレクトリ構造の作成（Model / View / Controller / Infrastructure）
  - .gitignore の調整（API keys, generated files など）

- [ ] **1.2 データモデルの実装**
  - `Lesson.swift` の作成（Lesson, Step, StepType）
  - `Quiz.swift` の作成（Quiz モデル）
  - `UserProgress.swift` の作成（進捗管理のラッパー）

- [ ] **1.3 Infrastructure 層の実装**
  - `LessonRepository.swift` - JSON からレッスンをロード
  - `QuizRepository.swift` - Quiz データのロード
  - `UserDefaultsStore.swift` - 進捗の永続化
  - `KeychainStore.swift` - API キーの安全な保存

- [ ] **1.4 サンプルデータの準備**
  - `Lessons/mean_basic.json` の作成（サンプル）
  - `Quizzes/mean_quiz.json` の作成（サンプル）
  - テスト用の静止画像1枚
  - テスト用の動画1本（3秒程度のダミーでOK）

**完了条件**:
- モデルとリポジトリのユニットテストが通る
- サンプル JSON が正しく読み込める

---

## Phase 2: レッスン一覧画面 📱
**期間**: 2〜3日
**目的**: SCR-01（レッスン一覧）の実装

### タスク

- [ ] **2.1 LessonListViewController の作成**
  - UITableView のセットアップ
  - LessonRepository からデータ取得

- [ ] **2.2 LessonListCell の作成**
  - タイトルラベル
  - 所要時間ラベル（"約5分"）
  - 完了チェックマーク（UserDefaults から取得）

- [ ] **2.3 画面遷移の実装**
  - セルタップで LessonDetailViewController へ遷移
  - lessonId を引き継ぐ

- [ ] **2.4 UI の調整**
  - セルのレイアウト調整
  - ナビゲーションバーの設定
  - セルの選択状態のハンドリング

**完了条件**:
- レッスン一覧が表示される
- 完了済みレッスンにチェックマークが表示される
- セルタップで次の画面へ遷移できる

---

## Phase 3: レッスン詳細画面 📖
**期間**: 4〜5日
**目的**: SCR-02（レッスン詳細）の実装

### タスク

- [ ] **3.1 LessonDetailViewController の作成**
  - UITableView のセットアップ
  - lessonId からレッスンデータを取得

- [ ] **3.2 Step セルの実装**
  - `StepTextCell` - テキスト表示用
  - `StepImageCell` - 静止画表示用
  - `StepVideoCell` - 動画表示用（AVPlayerLayer）

- [ ] **3.3 動画再生機能**
  - VideoCell 内でのタップ再生
  - AVPlayer のライフサイクル管理
  - 再生/一時停止の制御

- [ ] **3.4 完了記録機能**
  - スクロール位置の監視
  - 最後まで閲覧したら UserDefaults に記録
  - 一覧画面に戻った際の反映確認

- [ ] **3.5 下部ボタンの実装**
  - "質問してみる" ボタンの配置
  - AI 質問画面への遷移準備（Phase 5 で実装）

**完了条件**:
- テキスト・画像・動画が正しく表示される
- 動画がタップで再生される
- 最後まで見たレッスンが完了としてマークされる

---

## Phase 4: 確認問題画面 ✅
**期間**: 2〜3日
**目的**: SCR-04（確認問題）の実装

### タスク

- [ ] **4.1 QuizViewController の作成**
  - 問題文ラベル
  - 選択肢ボタン ×4
  - 解説ラベル（初期非表示）

- [ ] **4.2 問題表示ロジック**
  - QuizRepository からクイズデータ取得
  - 現在の問題インデックス管理

- [ ] **4.3 回答処理**
  - ボタンタップ時の正誤判定
  - 正解は緑、不正解は赤で色変化
  - 解説の表示

- [ ] **4.4 複数問題の管理**
  - "次の問題へ" ボタン
  - 全問終了時の処理
  - 完了状態の保存

- [ ] **4.5 レッスン詳細からの遷移**
  - レッスン完了後にクイズへ遷移する導線

**完了条件**:
- 4択問題が正しく表示される
- 回答と解説が機能する
- 複数問題を連続で解ける

---

## Phase 5: AI 質問機能 🤖
**期間**: 3〜4日
**目的**: SCR-05（AI質問）と SCR-06（設定）の実装

### タスク

- [ ] **5.1 SettingsViewController の作成**
  - API キー入力フィールド
  - 保存ボタン
  - 削除ボタン
  - KeychainStore への保存/削除処理

- [ ] **5.2 OpenAIClient の実装**
  - ChatCompletion API との通信
  - エラーハンドリング（ネットワークエラー、APIキー未設定など）
  - タイムアウト処理

- [ ] **5.3 ChatViewController の作成**
  - UITableView でチャットログ表示
  - ユーザーメッセージセル
  - AI メッセージセル

- [ ] **5.4 入力 UI の実装**
  - 画面下部固定の入力ビュー
  - UITextView + 送信ボタン
  - キーボード表示時のレイアウト調整

- [ ] **5.5 コンテキスト管理**
  - lessonId から該当レッスンのテキストを取得
  - System prompt の設定（300字制限、やさしい文体）
  - レッスン範囲外の質問の抑制

- [ ] **5.6 設定画面への導線**
  - API キー未設定時のアラート
  - 設定画面への遷移

**完了条件**:
- API キーが安全に保存される
- レッスン内容に基づいた質問ができる
- AI の回答が適切な長さと文体で返る

---

## Phase 6: コンテンツ作成と仕上げ 🎨
**期間**: 7〜10日
**目的**: 実際のレッスンコンテンツ作成と最終調整

### タスク

- [ ] **6.1 レッスンコンテンツの作成**
  - 記述統計 9レッスン分のテキスト執筆
    - 平均
    - 分散
    - 標準偏差
    - 代表値の特徴
    - ヒストグラム
    - 算術平均と加重平均
    - 変動係数
    - データのばらつきの直感
    - 1章まとめ

- [ ] **6.2 静止図の作成**
  - 各レッスンに2〜3枚の図を用意
  - 数式・グラフ・概念図

- [ ] **6.3 Manim アニメーションの作成**
  - 各レッスンに2本程度
  - 3〜6秒の短尺アニメ
  - mp4 形式で書き出し

- [ ] **6.4 確認問題の作成**
  - 章末に5問
  - 選択肢と解説の執筆

- [ ] **6.5 UI/UX の調整**
  - フォント・色・余白の統一
  - ナビゲーションバーのタイトル
  - ダークモード対応（任意）

- [ ] **6.6 エラーハンドリングの改善**
  - ネットワークエラー時のメッセージ
  - JSON 読み込み失敗時の処理
  - APIキー関連のエラーメッセージ

- [ ] **6.7 テスト**
  - 各画面の動作確認
  - 進捗保存の確認
  - 異常系のテスト

- [ ] **6.8 ドキュメント整備**
  - README の更新
  - 開発者向けメモの作成（任意）

**完了条件**:
- 9レッスン + 確認問題がすべて揃っている
- アニメーションがスムーズに再生される
- エンドツーエンドで学習フローが完結する

---

## マイルストーン一覧

| Phase | 完了予定日（目安） | 成果物 |
|-------|-------------------|--------|
| Phase 1 | Day 4 | データモデル・リポジトリ・サンプルJSON |
| Phase 2 | Day 7 | レッスン一覧画面 |
| Phase 3 | Day 12 | レッスン詳細画面（テキスト・画像・動画） |
| Phase 4 | Day 15 | 確認問題画面 |
| Phase 5 | Day 19 | AI質問機能・設定画面 |
| Phase 6 | Day 29 | 完成版（全コンテンツ + 仕上げ） |

---

## 優先度の考え方

### 🔴 High Priority
- Phase 1〜3（コア機能）
- サンプルデータでの動作確認

### 🟡 Medium Priority
- Phase 4（確認問題）
- Phase 5（AI機能）

### 🟢 Low Priority（余裕があれば）
- ダークモード対応
- アニメーションの凝った演出
- 進捗バーの実装

---

## リスクと対策

### リスク 1: Manim アニメーション作成に時間がかかる
**対策**:
- 最初は静止画のみでレッスンを完成させる
- アニメは後から追加する形で進める

### リスク 2: OpenAI API の回答制御が難しい
**対策**:
- System prompt を丁寧に調整
- 最初は固定の例文で動作確認
- 必要に応じて回答の後処理（文字数カットなど）を実装

### リスク 3: レッスン内容の執筆に時間がかかる
**対策**:
- まず3レッスン分だけ完成させて動作確認
- 残りは並行して執筆

---

## 次のステップ

1. **Phase 1 のタスクから着手**
2. 各フェーズ完了時にレビュー・テスト
3. 問題があれば次フェーズに進む前に修正

---

以上が StatEase-UIKit v1.0 の開発スケジュールです。
